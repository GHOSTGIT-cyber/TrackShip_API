<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ›°ï¸ Surveillance des navires - Seine</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="assets/style.css" />
</head>
<body>
    <!-- Badge Hostinger -->
    <div class="hostinger-badge">ğŸš€ Powered by Ghost - Architecture MVC</div>

    <!-- BanniÃ¨re d'alerte (ajoutÃ©e dynamiquement par JS) -->

    <!-- Compteur de rafraÃ®chissement -->
    <div id="compteurRefresh" class="compteur-refresh" style="display: none;">
        <div>Actualisation dans <span id="tempsRestant">10</span>s</div>
        <div id="modeActualisation" style="font-size: 12px; opacity: 0.8;">Mode: Normal (10s)</div>
    </div>

    <div class="container">
        <div class="header">
            <h1>ğŸ›°ï¸ Surveillance des navires en mouvement Foil in Paris</h1>
            <p> â€¢ surveillance automatique avec alertes de proximitÃ© â€¢ Suivi temps rÃ©el zone rouge â€¢ </p>
        </div>

        <div class="controls">
            <div class="form-group">
                <div>
                    <label for="token">ğŸ”‘ Token d'accÃ¨s</label>
                    <input type="text" id="token" placeholder="Votre token d'accÃ¨s">
                </div>
                <div>
                    <label for="rayon">ğŸ“ Rayon (km)</label>
                    <input type="number" id="rayon" value="3" min="1" max="50">
                </div>
                <div>
                    <label for="filtreNavires">ğŸš¢ Type de navires</label>
                    <select id="filtreNavires">
                        <option value="tous">Tous les navires</option>
                        <option value="mouvement">En mouvement uniquement</option>
                        <option value="arret">Ã€ l'arrÃªt uniquement</option>
                    </select>
                </div>
                <div>
                    <button class="btn" id="btnSurveillance">ğŸ” DÃ©marrer la surveillance</button>
                </div>
            </div>

            <!-- Indicateur de statut -->
            <div id="statusIndicator" class="status-indicator" style="display: none;">
                <span id="statusText">PrÃªt</span>
            </div>
        </div>

        <div class="content">
            <div class="map-container">
                <div id="map"></div>
            </div>

            <div class="sidebar">
                <!-- Statistiques -->
                <div class="stats">
                    <h3>ğŸ“Š Statistiques</h3>
                    <div class="stat-item">
                        <span class="stat-label">Navires dÃ©tectÃ©s</span>
                        <span class="stat-value" id="totalNavires">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸŸ¢ Zone d'approche (3km)</span>
                        <span class="stat-value" id="naviresApproche">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸŸ  Zone vigilance (2km)</span>
                        <span class="stat-value" id="naviresVigilance">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ”´ Zone alerte (1km)</span>
                        <span class="stat-value" id="naviresAlerte">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ¯ TrackÃ©s en temps rÃ©el</span>
                        <span class="stat-value" id="naviresTrackes">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸ“‹ Navires numÃ©rotÃ©s</span>
                        <span class="stat-value" id="naviresNumerotes">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">DerniÃ¨re MAJ</span>
                        <span class="stat-value" id="derniereMaj">Jamais</span>
                    </div>
                </div>

                <!-- Compteur journalier de passages -->
                <div id="panneauCompteurJournalier" class="compteur-journalier">
                    <h3>ğŸ“Š Compteur de passages - Zone Rouge</h3>
                    <div class="compteur-jour-actuel">
                        <div class="jour-label">Jour 1 (Aujourd'hui)</div>
                        <div class="jour-compteur">0 passage</div>
                    </div>
                    <div class="compteur-historique"></div>
                </div>

                <!-- Panneau d'attention intÃ©grÃ© dans la sidebar -->
                <div id="panneauAttentionSidebar" class="panneau-attention-sidebar" style="display: none;">
                    <div class="panneau-titre">
                        <span>ğŸŸ </span>
                        <strong>NAVIRES EN MOUVEMENT - ZONE 2KM</strong>
                    </div>
                    <div id="listeAttention"></div>
                </div>

                <!-- Liste navires surveillÃ©s -->
                <div class="navires-list">
                    <h3>ğŸŸ¢ Navires Conformes (<span id="nbConformes">0</span>)</h3>
                    <div id="listeNavires" class="loading">
                        Cliquez sur "DÃ©marrer la surveillance" pour commencer...
                    </div>
                </div>

                <!-- Nouvelle section pour les navires non conformes -->
                <div class="navires-list" id="sectionNonConformes" style="display: none;">
                    <h3>âš ï¸ Navires Non-Conformes (<span id="nbNonConformes">0</span>)</h3>
                    <div id="listeNonConformes" class="loading">
                        Aucun navire non conforme dÃ©tectÃ©
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Application MVC -->
    <script type="module" src="assets/js/main.js"></script>

    <!-- Script de gestion du token -->
    <script>
        // Charger le token depuis localStorage au dÃ©marrage
        document.addEventListener('DOMContentLoaded', () => {
            const tokenInput = document.getElementById('token');
            const savedToken = localStorage.getItem('euris_token');

            if (savedToken) {
                tokenInput.value = savedToken;
            }

            // Sauvegarder le token Ã  chaque modification
            tokenInput.addEventListener('change', () => {
                const token = tokenInput.value.trim();
                if (token) {
                    localStorage.setItem('euris_token', token);
                    console.log('âœ… Token sauvegardÃ©');
                }
            });
        });
    </script>
</body>
</html>
